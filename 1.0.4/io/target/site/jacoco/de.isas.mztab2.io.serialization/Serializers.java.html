<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Serializers.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jmztabm-io</a> &gt; <a href="index.source.html" class="el_package">de.isas.mztab2.io.serialization</a> &gt; <span class="el_source">Serializers.java</span></div><h1>Serializers.java</h1><pre class="source lang-java linenums">/* 
 * Copyright 2018 Leibniz-Institut für Analytische Wissenschaften – ISAS – e.V..
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package de.isas.mztab2.io.serialization;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlRootElement;
import de.isas.mztab2.model.Assay;
import de.isas.mztab2.model.IndexedElement;
import de.isas.mztab2.model.OptColumnMapping;
import de.isas.mztab2.model.Parameter;
import de.isas.mztab2.model.StudyVariable;
import de.isas.mztab2.model.Uri;
import java.io.IOException;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.stream.Collectors;
import java.util.stream.IntStream;
import javax.validation.ValidationException;
import lombok.extern.slf4j.Slf4j;
import uk.ac.ebi.pride.jmztab2.model.IMZTabColumn;
import uk.ac.ebi.pride.jmztab2.model.MZTabConstants;
import static uk.ac.ebi.pride.jmztab2.model.MZTabConstants.NULL;
import uk.ac.ebi.pride.jmztab2.model.MetadataElement;
import uk.ac.ebi.pride.jmztab2.model.MetadataProperty;

/**
 * &lt;p&gt;
 * Utility class providing helper methods for other serializers.&lt;/p&gt;
 *
 * @author nilshoffmann
 * @since 11/30/17
 *
 */
<span class="fc" id="L55">@Slf4j</span>
<span class="nc" id="L56">public class Serializers {</span>

    /**
     * &lt;p&gt;
     * getReference.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @param idx a {@link java.lang.Integer} object.
     * @return a {@link java.lang.String} object.
     */
    public static String getReference(Object element, Integer idx) {
<span class="fc" id="L67">        StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L68">        sb.append(getElementName(element).</span>
<span class="fc" id="L69">                orElseThrow(()</span>
                        -&gt; {
<span class="nc" id="L71">                    return new IllegalArgumentException(</span>
                            &quot;No mzTab element name mapping available for &quot; + element.
<span class="nc" id="L73">                                    getClass().</span>
<span class="nc" id="L74">                                    getName());</span>
                }));

<span class="fc" id="L77">        return sb.toString();</span>
    }

    /**
     * &lt;p&gt;
     * printAbundanceAssay.&lt;/p&gt;
     *
     * @param a a {@link de.isas.mztab2.model.Assay} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printAbundanceAssay(Assay a) {
<span class="nc" id="L88">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L89">        return sb.append(&quot;abundance_assay[&quot;).</span>
<span class="nc" id="L90">                append(a.getId()).</span>
<span class="nc" id="L91">                append(&quot;]&quot;).</span>
<span class="nc" id="L92">                toString();</span>
    }

    /**
     * &lt;p&gt;
     * printAbundanceStudyVar.&lt;/p&gt;
     *
     * @param sv a {@link de.isas.mztab2.model.StudyVariable} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printAbundanceStudyVar(StudyVariable sv) {
<span class="nc" id="L103">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L104">        return sb.append(&quot;abundance_study_variable[&quot;).</span>
<span class="nc" id="L105">                append(sv.getId()).</span>
<span class="nc" id="L106">                append(&quot;]&quot;).</span>
<span class="nc" id="L107">                toString();</span>
    }

    /**
     * &lt;p&gt;
     * printAbundanceCoeffVarStudyVar.&lt;/p&gt;
     *
     * @param sv a {@link de.isas.mztab2.model.StudyVariable} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printAbundanceCoeffVarStudyVar(StudyVariable sv) {
<span class="nc" id="L118">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L119">        return sb.append(&quot;abundance_coeffvar_study_variable[&quot;).</span>
<span class="nc" id="L120">                append(sv.getId()).</span>
<span class="nc" id="L121">                append(&quot;]&quot;).</span>
<span class="nc" id="L122">                toString();</span>
    }

    /**
     * &lt;p&gt;
     * printOptColumnMapping.&lt;/p&gt;
     *
     * @param ocm a {@link de.isas.mztab2.model.OptColumnMapping} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printOptColumnMapping(OptColumnMapping ocm) {
<span class="fc" id="L133">        StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L134">        log.debug(&quot;Identifier={}; OptColumnMapping: {}&quot;, ocm.getIdentifier(), ocm);</span>
<span class="fc bfc" id="L135" title="All 4 branches covered.">        if (&quot;global&quot;.equals(ocm.getIdentifier())||ocm.getIdentifier().startsWith(&quot;global&quot;)) {</span>
<span class="fc" id="L136">            sb.append(&quot;opt_&quot;);</span>
<span class="fc" id="L137">            sb.append(ocm.getIdentifier());</span>
<span class="fc bfc" id="L138" title="All 2 branches covered.">            if (ocm.getParam() != null) {</span>
<span class="fc" id="L139">                sb.append(&quot;_cv_&quot;).</span>
<span class="fc" id="L140">                        append(ocm.getParam().</span>
<span class="fc" id="L141">                                getCvAccession()).</span>
<span class="fc" id="L142">                        append(&quot;_&quot;).</span>
<span class="fc" id="L143">                        append(ocm.getParam().</span>
<span class="fc" id="L144">                                getName().</span>
<span class="fc" id="L145">                                replaceAll(&quot; &quot;, &quot;_&quot;));</span>
            }
        } else {
<span class="fc" id="L148">            log.debug(&quot;OptColumnMapping: {}&quot;, ocm);</span>
            // object reference case, value is now the actual value
<span class="fc" id="L150">            sb.append(ocm.getIdentifier());</span>
        }
<span class="fc" id="L152">        log.debug(&quot;asString: {}&quot;, sb.toString());</span>
//        //TODO: check for valid characters in definition
//        //valid characters: ‘A’-‘Z’, ‘a’-‘z’, ‘0’-‘9’, ‘’, ‘-’, ‘[’, ‘]’, and ‘:’.
//        //[A-Za-z0-9\[\]-:]+
<span class="fc" id="L156">        return sb.toString();</span>
    }

    /**
     * &lt;p&gt;
     * addIndexedLine for elements like assay[1] that have an id and one
     * additional property element&lt;/p&gt;
     *
     * @param &lt;T&gt; the type of {@link IndexedElement}.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param indexedElement a {@link de.isas.mztab2.model.Parameter} object.
     */
    public static &lt;T extends IndexedElement&gt; void addIndexedLine(
            JsonGenerator jg, SerializerProvider sp, String prefix,
            Object element, T indexedElement) {
<span class="fc" id="L175">        addIndexedLine(jg, sp, prefix, element, Arrays.asList(indexedElement));</span>
<span class="fc" id="L176">    }</span>

    /**
     * &lt;p&gt;
     * addIndexedLine for elements like assay[1] that have an id and a list of
     * additional property elements&lt;/p&gt;
     *
     * @param &lt;T&gt; the type of {@link IndexedElement}.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param indexedElementList a {@link java.util.List} object.
     */
    public static &lt;T extends IndexedElement&gt; void addIndexedLine(
            JsonGenerator jg, SerializerProvider sp, String prefix,
            Object element,
            List&lt;T&gt; indexedElementList) {
<span class="fc" id="L195">        Optional&lt;List&lt;T&gt;&gt; iel = Optional.ofNullable(indexedElementList);</span>
<span class="pc bpc" id="L196" title="2 of 4 branches missed.">        if (!iel.isPresent() || indexedElementList.isEmpty()) {</span>

<span class="nc" id="L198">            log.debug(</span>
                    &quot;Skipping null or empty indexed element list values for {}&quot;,
<span class="nc" id="L200">                    getElementName(</span>
                            element));
<span class="nc" id="L202">            return;</span>
        }
        try {
<span class="fc" id="L205">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L207">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L209">            jg.writeString(new StringBuilder().append(getElementName(element).</span>
<span class="fc" id="L210">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L212">                        return new ElementNameMappingException(&quot;unknown&quot;, element);</span>
                    })).
<span class="fc" id="L214">                    toString());</span>
            //value
<span class="fc" id="L216">            jg.writeString(indexedElementList.stream().</span>
<span class="fc" id="L217">                    map((indexedElement)</span>
                            -&gt; {
<span class="fc bfc" id="L219" title="All 2 branches covered.">                        if (indexedElement instanceof Parameter) {</span>
<span class="fc" id="L220">                            return new ParameterConverter().convert(</span>
                                    (Parameter) indexedElement);
<span class="pc bpc" id="L222" title="1 of 2 branches missed.">                        } else if (indexedElement instanceof Uri) {</span>
<span class="fc" id="L223">                            return new UriConverter().convert((Uri) indexedElement);</span>
                        } else {
<span class="nc" id="L225">                            throw new IllegalArgumentException(</span>
<span class="nc" id="L226">                                    &quot;Serialization of type &quot; + indexedElement.getClass() + &quot; currently not supported!&quot;);</span>
                        }
                    }).
<span class="fc" id="L229">                    collect(Collectors.joining(&quot;|&quot;)));</span>
<span class="fc" id="L230">            jg.writeEndArray();</span>
<span class="nc" id="L231">        } catch (IOException ex) {</span>

<span class="nc" id="L233">            log.error(&quot;Caught IO Exception while trying to write indexed line:&quot;,</span>
                    ex);
<span class="fc" id="L235">        }</span>
<span class="fc" id="L236">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithParameters.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param parameterList a {@link java.util.List} object.
     */
    public static void addLineWithParameters(JsonGenerator jg, String prefix,
            Object element,
            List&lt;Parameter&gt; parameterList) {
<span class="pc bpc" id="L250" title="2 of 4 branches missed.">        if (parameterList == null || parameterList.isEmpty()) {</span>

<span class="nc" id="L252">            log.debug(</span>
<span class="nc" id="L253">                    &quot;Skipping null or empty parameter list values for &quot; + getElementName(</span>
                            element));
<span class="nc" id="L255">            return;</span>
        }
        try {
<span class="fc" id="L258">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L260">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L262">            jg.writeString(new StringBuilder().append(getElementName(element).</span>
<span class="fc" id="L263">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L265">                        return new ElementNameMappingException(&quot;unknown&quot;, element);</span>
                    })).
<span class="fc" id="L267">                    toString());</span>
            //value
<span class="fc" id="L269">            jg.writeString(parameterList.stream().</span>
<span class="fc" id="L270">                    map((parameter)</span>
                            -&gt; {
<span class="fc" id="L272">                        return new ParameterConverter().convert(parameter);</span>
                    }).
<span class="fc" id="L274">                    collect(Collectors.joining(&quot;|&quot;)));</span>
<span class="fc" id="L275">            jg.writeEndArray();</span>
<span class="nc" id="L276">        } catch (IOException ex) {</span>
<span class="nc" id="L277">            log.error(</span>
                    &quot;Caught IO Exception while trying to write line with parameters:&quot;,
                    ex);
<span class="fc" id="L280">        }</span>
<span class="fc" id="L281">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithPropertyParameters.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param propertyName a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.util.List} object.
     */
    public static void addLineWithPropertyParameters(JsonGenerator jg,
            String prefix,
            String propertyName, Object element,
            List&lt;Parameter&gt; value) {
<span class="pc bpc" id="L297" title="2 of 4 branches missed.">        if (value == null || value.isEmpty()) {</span>

<span class="nc" id="L299">            log.debug(&quot;Skipping null or empty values for {}&quot;,</span>
<span class="nc" id="L300">                    getElementName(</span>
                            element));
<span class="nc" id="L302">            return;</span>
        }
<span class="fc" id="L304">        addLineWithProperty(jg, prefix, propertyName, element, value.stream().</span>
<span class="fc" id="L305">                map((parameter)</span>
                        -&gt; {
<span class="fc" id="L307">                    return new ParameterConverter().convert(parameter);</span>
                }).
<span class="fc" id="L309">                collect(Collectors.joining(&quot;|&quot;)));</span>
<span class="fc" id="L310">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithMetadataProperty.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param property a {@link uk.ac.ebi.pride.jmztab2.model.MetadataProperty}
     * object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.lang.Object} object.
     */
    public static void addLineWithMetadataProperty(JsonGenerator jg,
            String prefix, MetadataProperty property, Object element,
            Object... value) {
<span class="fc" id="L326">        addLineWithProperty(jg, prefix, property.getName(), element, value);</span>
<span class="fc" id="L327">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithNullProperty.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param propertyName a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     */
    public static void addLineWithNullProperty(JsonGenerator jg, String prefix,
            String propertyName, Object element) {
        try {
<span class="fc" id="L341">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L343">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L345">            String key = getElementName(element).</span>
<span class="fc" id="L346">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L348">                        return new ElementNameMappingException(propertyName, element);</span>
                    });
<span class="pc bpc" id="L350" title="1 of 2 branches missed.">            if (propertyName == null) {</span>
<span class="nc" id="L351">                jg.writeString(key);</span>
            } else {
<span class="fc" id="L353">                jg.writeString(key + &quot;-&quot; + propertyName);</span>
            }
            //value
<span class="fc" id="L356">            jg.writeString(NULL);</span>
<span class="fc" id="L357">            jg.writeEndArray();</span>
<span class="nc" id="L358">        } catch (IOException ex) {</span>

<span class="nc" id="L360">            log.error(</span>
                    &quot;Caught exception while trying to write line with null property:&quot;,
                    ex);
<span class="fc" id="L363">        }</span>
<span class="fc" id="L364">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithProperty.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param propertyName a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.lang.Object} object.
     */
    public static void addLineWithProperty(JsonGenerator jg, String prefix,
            String propertyName, Object element,
            Object... value) {
<span class="pc bpc" id="L379" title="2 of 4 branches missed.">        if (value == null || value.length == 0) {</span>

<span class="nc" id="L381">            log.debug(&quot;Skipping null or empty values for {}&quot;,</span>
<span class="nc" id="L382">                    getElementName(</span>
                            element));
<span class="nc" id="L384">            return;</span>
        }
<span class="pc bpc" id="L386" title="1 of 4 branches missed.">        if (value.length == 1 &amp;&amp; (value[0] == null)) {</span>

<span class="fc" id="L388">            log.debug(&quot;Skipping empty value for {}&quot;, getElementName(</span>
                    element));
<span class="fc" id="L390">            return;</span>
        }
        try {
<span class="fc" id="L393">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L395">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L397">            String key = getElementName(element).</span>
<span class="fc" id="L398">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L400">                        return new ElementNameMappingException(propertyName, element);</span>
                    });
<span class="fc bfc" id="L402" title="All 2 branches covered.">            if (propertyName == null) {</span>
<span class="fc" id="L403">                jg.writeString(key);</span>
            } else {
<span class="fc" id="L405">                jg.writeString(key + &quot;-&quot; + propertyName);</span>
            }
            //value
<span class="fc bfc" id="L408" title="All 2 branches covered.">            for (Object o : value) {</span>
<span class="fc" id="L409">                jg.writeObject(o);</span>
            }
<span class="fc" id="L411">            jg.writeEndArray();</span>
<span class="nc" id="L412">        } catch (IOException ex) {</span>

<span class="nc" id="L414">            log.error(</span>
                    &quot;Caught IO exception while trying to write line with property:&quot;,
                    ex);
<span class="fc" id="L417">        }</span>
<span class="fc" id="L418">    }</span>

    /**
     * &lt;p&gt;
     * addLine.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.lang.Object} object.
     */
    public static void addLine(JsonGenerator jg, String prefix, Object element,
            Object... value) {
<span class="fc" id="L431">        addLineWithProperty(jg, prefix, null, element, value);</span>
<span class="fc" id="L432">    }</span>

    /**
     * &lt;p&gt;
     * getElementName.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @return a {@link java.util.Optional} object.
     */
    public static Optional&lt;String&gt; getElementName(Object element) {
<span class="fc bfc" id="L442" title="All 2 branches covered.">        if (element instanceof String) {</span>
<span class="fc" id="L443">            return Optional.of((String) element);</span>
        }
<span class="fc bfc" id="L445" title="All 2 branches covered.">        if (element instanceof MetadataElement) {</span>
<span class="fc" id="L446">            return Optional.ofNullable(((MetadataElement) element).getName());</span>
        }
<span class="fc" id="L448">        JacksonXmlRootElement rootElement = element.getClass().</span>
<span class="fc" id="L449">                getAnnotation(JacksonXmlRootElement.class);</span>
<span class="pc bpc" id="L450" title="1 of 2 branches missed.">        if (rootElement != null) {</span>
<span class="fc" id="L451">            String underscoreName = camelCaseToUnderscoreLowerCase(</span>
<span class="fc" id="L452">                    rootElement.localName());</span>
<span class="pc bpc" id="L453" title="1 of 2 branches missed.">            if (element instanceof IndexedElement) {</span>
<span class="fc" id="L454">                Integer id = Optional.ofNullable(((IndexedElement) element).getId()).orElseThrow(() -&gt; </span>
<span class="nc" id="L455">                        new NullPointerException(</span>
                            &quot;Field 'id' must not be null for element '&quot; + underscoreName + &quot;'!&quot;)
                );
<span class="fc" id="L458">                return Optional.of(</span>
                        underscoreName + &quot;[&quot; + id + &quot;]&quot;);
            }
<span class="nc" id="L461">            return Optional.ofNullable(underscoreName);</span>
        }
<span class="nc" id="L463">        return Optional.empty();</span>
    }

    /**
     * &lt;p&gt;
     * getPropertyNames.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @return a {@link java.util.List} object.
     */
    public static List&lt;String&gt; getPropertyNames(Object element) {
<span class="nc" id="L474">        return Arrays.asList(element.getClass().</span>
<span class="nc" id="L475">                getAnnotationsByType(JsonProperty.class)).</span>
<span class="nc" id="L476">                stream().</span>
<span class="nc" id="L477">                map((jsonProperty)</span>
                        -&gt; {
<span class="nc" id="L479">                    return jsonProperty.value();</span>
                }).
<span class="nc" id="L481">                collect(Collectors.toList());</span>
    }

    /**
     * &lt;p&gt;
     * asMap.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @return a {@link java.util.Map} object.
     */
    public static Map&lt;String, Object&gt; asMap(Object element) {
<span class="nc" id="L492">        ObjectMapper objectMapper = new ObjectMapper();</span>
<span class="nc" id="L493">        return objectMapper.convertValue(element, Map.class);</span>
    }

    /**
     * &lt;p&gt;
     * camelCaseToUnderscoreLowerCase.&lt;/p&gt;
     *
     * @param camelCase a {@link java.lang.String} object.
     * @return a {@link java.lang.String} object.
     */
    public static String camelCaseToUnderscoreLowerCase(String camelCase) {
<span class="fc" id="L504">        Matcher m = Pattern.compile(&quot;(?&lt;=[a-z])[A-Z]&quot;).</span>
<span class="fc" id="L505">                matcher(camelCase);</span>

<span class="fc" id="L507">        StringBuffer sb = new StringBuffer();</span>
<span class="fc bfc" id="L508" title="All 2 branches covered.">        while (m.find()) {</span>
<span class="fc" id="L509">            m.appendReplacement(sb, &quot;_&quot; + m.group().</span>
<span class="fc" id="L510">                    toLowerCase());</span>
        }
<span class="fc" id="L512">        m.appendTail(sb);</span>
<span class="fc" id="L513">        return sb.toString().</span>
<span class="fc" id="L514">                toLowerCase();</span>
    }

    /**
     * &lt;p&gt;
     * addSubElementStrings.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param subElementName a {@link java.lang.String} object.
     * @param subElements a {@link java.util.List} object.
     * @param oneLine a boolean.
     */
    public static void addSubElementStrings(JsonGenerator jg, String prefix,
            Object element, String subElementName, List&lt;?&gt; subElements,
            boolean oneLine) {
<span class="fc bfc" id="L531" title="All 2 branches covered.">        if (checkForNull(element, subElements, subElementName)) {</span>
<span class="fc" id="L532">            return;</span>
        }
<span class="fc" id="L534">        Serializers.getElementName(element).</span>
<span class="fc" id="L535">                ifPresent((elementName)</span>
                        -&gt; {
<span class="fc bfc" id="L537" title="All 2 branches covered.">                    if (oneLine) {</span>
<span class="fc" id="L538">                        addLine(jg, prefix,</span>
                                elementName + &quot;-&quot; + subElementName,
<span class="fc" id="L540">                                subElements.stream().</span>
<span class="fc" id="L541">                                        map((t)</span>
                                                -&gt; {
<span class="fc" id="L543">                                            return t.toString();</span>
                                        }).
<span class="fc" id="L545">                                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR)));</span>
                    } else {
<span class="fc" id="L547">                        IntStream.range(0, subElements.</span>
<span class="fc" id="L548">                                size()).</span>
<span class="fc" id="L549">                                forEachOrdered(i</span>
                                        -&gt; {
<span class="fc" id="L551">                                    addLine(jg, prefix,</span>
                                            elementName + &quot;-&quot; + subElementName + &quot;[&quot; + (i + 1) + &quot;]&quot;,
                                            subElements.
<span class="fc" id="L554">                                                    get(i));</span>
<span class="fc" id="L555">                                });</span>
                    }
<span class="fc" id="L557">                });</span>

<span class="fc" id="L559">    }</span>

    /**
     * &lt;p&gt;
     * addSubElementParameter.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param subElementName a {@link java.lang.String} object.
     * @param subElement a {@link de.isas.mztab2.model.Parameter} object.
     */
    public static void addSubElementParameter(JsonGenerator jg, String prefix,
            Object element, String subElementName, Parameter subElement) {
<span class="fc bfc" id="L573" title="All 2 branches covered.">        if (subElement == null) {</span>
<span class="fc" id="L574">            String elementName = Serializers.getElementName(element).</span>
<span class="fc" id="L575">                    orElse(&quot;undefined&quot;);</span>

<span class="fc" id="L577">            log.debug(&quot;''{}-{}'' is null or empty!&quot;, new Object[]{</span>
                elementName,
                subElementName});
<span class="fc" id="L580">            return;</span>
        }
<span class="fc" id="L582">        addSubElementStrings(jg, prefix, element, subElementName, Arrays.asList(</span>
<span class="fc" id="L583">                new ParameterConverter().convert(subElement)), true);</span>
<span class="fc" id="L584">    }</span>

    /**
     * &lt;p&gt;
     * addSubElementParameters.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param subElementName a {@link java.lang.String} object.
     * @param subElements a {@link java.util.List} object.
     * @param oneLine a boolean.
     */
    public static void addSubElementParameters(JsonGenerator jg, String prefix,
            Object element, String subElementName, List&lt;Parameter&gt; subElements,
            boolean oneLine) {
<span class="fc bfc" id="L600" title="All 2 branches covered.">        if (checkForNull(element, subElements, subElementName)) {</span>
<span class="fc" id="L601">            return;</span>
        }
<span class="fc" id="L603">        addSubElementStrings(jg, prefix, element, subElementName,</span>
<span class="fc" id="L604">                subElements.stream().</span>
<span class="fc" id="L605">                        map((parameter)</span>
                                -&gt; {
                            try {
<span class="fc" id="L608">                                return new ParameterConverter().convert(parameter);</span>
<span class="nc" id="L609">                            } catch (IllegalArgumentException npe) {</span>

<span class="nc" id="L611">                                log.debug(&quot;parameter is null for {}&quot;,</span>
                                        subElementName);
<span class="nc" id="L613">                                return &quot;null&quot;;</span>
                            }
                        }).
<span class="fc" id="L616">                        collect(Collectors.toList()), oneLine);</span>
<span class="fc" id="L617">    }</span>

    /**
     * &lt;p&gt;
     * checkForNull.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @param subElements a {@link java.util.List} object.
     * @param subElementName a {@link java.lang.String} object.
     * @return a boolean.
     */
    public static boolean checkForNull(Object element, List&lt;?&gt; subElements,
            String subElementName) {
<span class="fc" id="L630">        String elementName = Serializers.getElementName(element).</span>
<span class="fc" id="L631">                orElse(&quot;undefined&quot;);</span>
<span class="fc bfc" id="L632" title="All 4 branches covered.">        if (subElements == null || subElements.isEmpty()) {</span>

<span class="fc" id="L634">            log.debug(&quot;''{}-{}'' is null or empty!&quot;, new Object[]{</span>
                elementName,
                subElementName});
<span class="fc" id="L637">            return true;</span>
        }
<span class="fc" id="L639">        return false;</span>
    }

    /**
     * &lt;p&gt;
     * writeString.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.String} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeString(String columnName, JsonGenerator jg,
            String value) throws IOException {
<span class="fc bfc" id="L654" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L655">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc" id="L657">            jg.writeStringField(columnName, value);</span>
        }
<span class="fc" id="L659">    }</span>

    /**
     * &lt;p&gt;
     * writeString.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.String} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeString(IMZTabColumn column, JsonGenerator jg,
            String value) throws IOException {
<span class="fc" id="L674">        writeString(column.getHeader(), jg, value);</span>
<span class="fc" id="L675">    }</span>

    /**
     * &lt;p&gt;
     * writeObject.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param value a {@link java.lang.Object} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeObject(String columnName, JsonGenerator jg,
            SerializerProvider sp,
            Object value) throws IOException {
<span class="fc bfc" id="L692" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L693">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc bfc" id="L695" title="All 2 branches covered.">            if (value instanceof Parameter) {</span>
<span class="fc" id="L696">                jg.writeStringField(columnName, new ParameterConverter().</span>
<span class="fc" id="L697">                        convert((Parameter) value));</span>
<span class="pc bpc" id="L698" title="1 of 2 branches missed.">            } else if (value instanceof String) {</span>
<span class="fc" id="L699">                jg.writeStringField(columnName, (String) value);</span>
            } else {
<span class="nc" id="L701">                throw new IllegalArgumentException(</span>
<span class="nc" id="L702">                        &quot;Serialization of objects of type &quot; + value.getClass()</span>
                        + &quot; currently not supported!&quot;);
            }

        }
<span class="fc" id="L707">    }</span>

    /**
     * &lt;p&gt;
     * writeObject.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param value a {@link java.lang.Object} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeObject(IMZTabColumn column, JsonGenerator jg,
            SerializerProvider sp, Object value) throws IOException {
<span class="fc" id="L724">        writeObject(column.getHeader(), jg, sp, value);</span>
<span class="fc" id="L725">    }</span>

    /**
     * &lt;p&gt;
     * writeAsNumberArray.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsNumberArray(IMZTabColumn column, JsonGenerator jg,
            List&lt;? extends Number&gt; elements) {
<span class="fc" id="L738">        writeAsNumberArray(column.getHeader(), jg, elements);</span>
<span class="fc" id="L739">    }</span>

    /**
     * &lt;p&gt;
     * writeAsNumberArray.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsNumberArray(String columnName, JsonGenerator jg,
            List&lt;? extends Number&gt; elements) {
        try {
<span class="fc bfc" id="L752" title="All 2 branches covered.">            if (elements == null) {</span>
<span class="fc" id="L753">                jg.writeNullField(columnName);</span>
            } else {
<span class="fc" id="L755">                String arrayElements = elements.stream().</span>
<span class="fc" id="L756">                        map((number)</span>
                                -&gt; {
<span class="fc bfc" id="L758" title="All 2 branches covered.">                            if (number == null) {</span>
<span class="fc" id="L759">                                return MZTabConstants.NULL;</span>
<span class="pc bpc" id="L760" title="1 of 2 branches missed.">                            } else if (number instanceof Short) {</span>
<span class="nc" id="L761">                                return &quot;&quot; + number.shortValue();</span>
<span class="fc bfc" id="L762" title="All 2 branches covered.">                            } else if (number instanceof Integer) {</span>
<span class="fc" id="L763">                                return &quot;&quot; + number.intValue();</span>
<span class="pc bpc" id="L764" title="1 of 2 branches missed.">                            } else if (number instanceof Long) {</span>
<span class="nc" id="L765">                                return &quot;&quot; + number.longValue();</span>
<span class="pc bpc" id="L766" title="1 of 2 branches missed.">                            } else if (number instanceof Float) {</span>
<span class="nc" id="L767">                                return &quot;&quot; + number.floatValue();</span>
                            } else {
<span class="fc" id="L769">                                return &quot;&quot; + number.doubleValue();</span>
                            }
                        }).
<span class="fc" id="L772">                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR));</span>
<span class="fc bfc" id="L773" title="All 2 branches covered.">                if (arrayElements.isEmpty()) {</span>
<span class="fc" id="L774">                    jg.writeNullField(columnName);</span>
                } else {
<span class="fc" id="L776">                    jg.writeStringField(columnName, arrayElements);</span>
                }
            }
<span class="nc" id="L779">        } catch (IOException ex) {</span>
<span class="nc" id="L780">            log.error(</span>
                    &quot;Caught IO exception while trying to write as number array: &quot;,
                    ex);
<span class="fc" id="L783">        }</span>
<span class="fc" id="L784">    }</span>

    /**
     * &lt;p&gt;
     * writeAsStringArray.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsStringArray(IMZTabColumn column, JsonGenerator jg,
            List&lt;String&gt; elements) {
<span class="fc" id="L797">        writeAsStringArray(column.getHeader(), jg, elements);</span>
<span class="fc" id="L798">    }</span>

    /**
     * &lt;p&gt;
     * writeAsStringArray.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsStringArray(JsonGenerator jg,
            List&lt;String&gt; elements) {
        try {
<span class="nc bnc" id="L810" title="All 2 branches missed.">            if (elements == null) {</span>
<span class="nc" id="L811">                jg.writeNull();</span>
            } else {
<span class="nc" id="L813">                String arrayElements = elements.stream().</span>
<span class="nc" id="L814">                        map((t)</span>
                                -&gt; {
<span class="nc bnc" id="L816" title="All 2 branches missed.">                            if (t == null) {</span>
<span class="nc" id="L817">                                return MZTabConstants.NULL;</span>
                            }
<span class="nc" id="L819">                            return t;</span>
                        }).
<span class="nc" id="L821">                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR));</span>
<span class="nc bnc" id="L822" title="All 2 branches missed.">                if (arrayElements.isEmpty()) {</span>
<span class="nc" id="L823">                    jg.writeNull();</span>
                } else {
<span class="nc" id="L825">                    jg.writeString(arrayElements);</span>
                }
            }
<span class="nc" id="L828">        } catch (IOException ex) {</span>
<span class="nc" id="L829">            log.error(&quot;Error while trying to write as string array:&quot;, ex);</span>
<span class="nc" id="L830">        }</span>
<span class="nc" id="L831">    }</span>

    /**
     * &lt;p&gt;
     * writeAsStringArray.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsStringArray(String columnName, JsonGenerator jg,
            List&lt;String&gt; elements) {
        try {
<span class="fc bfc" id="L844" title="All 2 branches covered.">            if (elements == null) {</span>
<span class="fc" id="L845">                jg.writeNullField(columnName);</span>
            } else {
<span class="fc" id="L847">                String arrayElements = elements.stream().</span>
<span class="fc" id="L848">                        map((t)</span>
                                -&gt; {
<span class="pc bpc" id="L850" title="1 of 2 branches missed.">                            if (t == null) {</span>
<span class="nc" id="L851">                                return MZTabConstants.NULL;</span>
                            }
<span class="fc" id="L853">                            return t;</span>
                        }).
<span class="fc" id="L855">                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR));</span>
<span class="fc bfc" id="L856" title="All 2 branches covered.">                if (arrayElements.isEmpty()) {</span>
<span class="fc" id="L857">                    jg.writeNullField(columnName);</span>
                } else {
<span class="fc" id="L859">                    jg.writeStringField(columnName, arrayElements);</span>
                }
            }
<span class="nc" id="L862">        } catch (IOException ex) {</span>
<span class="nc" id="L863">            log.error(&quot;Error while trying to write as string array: &quot;, ex);</span>
<span class="fc" id="L864">        }</span>
<span class="fc" id="L865">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Integer} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(String columnName, JsonGenerator jg,
            Integer value) throws IOException {
<span class="fc bfc" id="L879" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L880">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc" id="L882">            jg.writeNumberField(columnName, value);</span>
        }
<span class="fc" id="L884">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Integer} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(IMZTabColumn column, JsonGenerator jg,
            Integer value) throws IOException {
<span class="fc" id="L899">        writeNumber(column.getHeader(), jg, value);</span>
<span class="fc" id="L900">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Double} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(String columnName, JsonGenerator jg,
            Double value) throws IOException {
<span class="fc bfc" id="L914" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L915">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc bfc" id="L917" title="All 2 branches covered.">            if (value.equals(Double.NaN)) {</span>
<span class="fc" id="L918">                jg.writeStringField(columnName, MZTabConstants.CALCULATE_ERROR);</span>
<span class="pc bpc" id="L919" title="1 of 2 branches missed.">            } else if (value.equals(Double.POSITIVE_INFINITY)) {</span>
<span class="nc" id="L920">                jg.writeStringField(columnName, MZTabConstants.INFINITY);</span>
            } else {
<span class="fc" id="L922">                jg.writeNumberField(columnName, value);</span>
            }
        }
<span class="fc" id="L925">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Double} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(IMZTabColumn column, JsonGenerator jg,
            Double value) throws IOException {
<span class="fc" id="L940">        writeNumber(column.getHeader(), jg, value);</span>
<span class="fc" id="L941">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Integer} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(JsonGenerator jg, Integer value) throws IOException {
<span class="nc bnc" id="L953" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L954">            jg.writeNull();</span>
        } else {
<span class="nc" id="L956">            jg.writeNumber(value);</span>
        }
<span class="nc" id="L958">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Double} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(JsonGenerator jg, Double value) throws IOException {
<span class="nc bnc" id="L970" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L971">            jg.writeNull();</span>
        } else {
<span class="nc" id="L973">            jg.writeNumber(value);</span>
        }
<span class="nc" id="L975">    }</span>

    /**
     * &lt;p&gt;
     * writeOptColumnMappings.&lt;/p&gt;
     *
     * @param optColumnMappings a {@link java.util.List} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp the serialization provider.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeOptColumnMappings(
            List&lt;OptColumnMapping&gt; optColumnMappings,
            JsonGenerator jg, SerializerProvider sp) throws IOException {
<span class="fc" id="L990">        for (OptColumnMapping ocm : Optional.ofNullable(</span>
                optColumnMappings).
<span class="fc bfc" id="L992" title="All 2 branches covered.">                orElse(Collections.emptyList())) {</span>
            // write global or indexed element param objects
<span class="fc bfc" id="L994" title="All 2 branches covered.">            if (ocm.getParam() != null) {</span>
<span class="fc" id="L995">                writeObject(Serializers.printOptColumnMapping(ocm), jg, sp, ocm.</span>
<span class="fc bfc" id="L996" title="All 2 branches covered.">                        getValue() == null ? </span>
<span class="pc bpc" id="L997" title="2 of 4 branches missed.">                        (ocm.getParam().getValue() == null || ocm.getParam().getValue().isEmpty() ? </span>
<span class="pc" id="L998">                                NULL : ocm.getParam().getValue()) : ocm.getValue());</span>
            } else { // write global opt column objects with the value
<span class="fc" id="L1000">                writeObject(Serializers.printOptColumnMapping(ocm), jg, sp, ocm.</span>
<span class="fc bfc" id="L1001" title="All 2 branches covered.">                        getValue() == null ? NULL : ocm.getValue());</span>
            }
<span class="fc" id="L1003">        }</span>
<span class="fc" id="L1004">    }</span>

    /**
     * &lt;p&gt;
     * writeIndexedValues.&lt;/p&gt;
     *
     * @param prefix a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param values a {@link java.util.List} object.
     */
    public static void writeIndexedDoubles(String prefix,
            JsonGenerator jg, List&lt;Double&gt; values) {
<span class="fc" id="L1016">        IntStream.range(0, values.</span>
<span class="fc" id="L1017">                size()).</span>
<span class="fc" id="L1018">                forEachOrdered(i</span>
                        -&gt; {
                    try {
<span class="fc" id="L1021">                        Serializers.writeNumber(</span>
                                prefix + &quot;[&quot; + (i + 1) + &quot;]&quot;,
                                jg,
                                values.
<span class="fc" id="L1025">                                        get(i));</span>
<span class="nc" id="L1026">                    } catch (IOException ex) {</span>
<span class="nc" id="L1027">                        log.error(</span>
                                &quot;Caught IO exception while trying to write indexed doubles:&quot;,
                                ex);
<span class="fc" id="L1030">                    }</span>
<span class="fc" id="L1031">                });</span>
<span class="fc" id="L1032">    }</span>

    public static void checkIndexedElement(IndexedElement element) {
<span class="fc" id="L1035">        Integer id = Optional.ofNullable(element.getId()).orElseThrow(() -&gt;</span>
<span class="nc" id="L1036">            new ValidationException(</span>
<span class="nc" id="L1037">                    &quot;'id' field of &quot; + element.toString() + &quot; must not be null!&quot;));</span>
<span class="pc bpc" id="L1038" title="1 of 2 branches missed.">        if (id &lt; 1) {</span>
<span class="nc" id="L1039">            throw new ValidationException(</span>
<span class="nc" id="L1040">                    &quot;'id' field of &quot; + element.toString() + &quot; must have a value greater to equal to 1!&quot;);</span>
        }
<span class="fc" id="L1042">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>