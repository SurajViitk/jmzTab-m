<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MZTabDataLineParser.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jmztabm-io</a> &gt; <a href="index.source.html" class="el_package">uk.ac.ebi.pride.jmztab2.utils.parser</a> &gt; <span class="el_source">MZTabDataLineParser.java</span></div><h1>MZTabDataLineParser.java</h1><pre class="source lang-java linenums">/* 
 * Copyright 2018 Leibniz-Institut für Analytische Wissenschaften – ISAS – e.V..
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package uk.ac.ebi.pride.jmztab2.utils.parser;

import de.isas.mztab2.io.serialization.ParameterConverter;
import de.isas.mztab2.model.Metadata;
import de.isas.mztab2.model.MsRun;
import de.isas.mztab2.model.Parameter;
import de.isas.mztab2.model.SpectraRef;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.Optional;
import java.util.SortedMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import lombok.extern.slf4j.Slf4j;
import uk.ac.ebi.pride.jmztab2.model.IMZTabColumn;
import uk.ac.ebi.pride.jmztab2.model.MZBoolean;
import uk.ac.ebi.pride.jmztab2.model.MZTabColumnFactory;
import uk.ac.ebi.pride.jmztab2.model.MZTabConstants;
import static uk.ac.ebi.pride.jmztab2.model.MZTabConstants.*;
import uk.ac.ebi.pride.jmztab2.model.MZTabUtils;
import static uk.ac.ebi.pride.jmztab2.model.MZTabUtils.*;
import uk.ac.ebi.pride.jmztab2.model.SplitList;
import uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType;
import uk.ac.ebi.pride.jmztab2.utils.errors.LogicalErrorType;
import uk.ac.ebi.pride.jmztab2.utils.errors.MZTabError;
import uk.ac.ebi.pride.jmztab2.utils.errors.MZTabErrorList;
import uk.ac.ebi.pride.jmztab2.utils.errors.MZTabException;

/**
 * This class allows the validation and loading of the data into mzTab domain
 * objects.
 *
 * NOTICE: {@link uk.ac.ebi.pride.jmztab2.model.MZTabColumnFactory} maintain a
 * couple of {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn} which have
 * internal logical position and order. In physical mzTab file, we allow user
 * not obey this logical position organized way, and provide their date with own
 * order. In order to distinguish them, we use physical position (a positive
 * integer) to record the column location in mzTab file. And use
 * {@link uk.ac.ebi.pride.jmztab2.utils.parser.PositionMapping} structure to
 * maintain the mapping between them.
 *
 * @param &lt;T&gt; the type of domain object the parser creates.
 * @see SMLLineParser
 * @see SMFLineParser
 * @see SMELineParser
 * @author qingwei
 * @since 14/02/13
 *
 */
<span class="fc" id="L66">@Slf4j</span>
public abstract class MZTabDataLineParser&lt;T&gt; extends MZTabLineParser {

    protected MZTabColumnFactory factory;
    protected PositionMapping positionMapping;
    protected SortedMap&lt;String, Integer&gt; exchangeMapping; // reverse the key and value of positionMapping.

    protected SortedMap&lt;Integer, IMZTabColumn&gt; mapping;   // logical position --&gt; offset
    protected Metadata metadata;

    /**
     * &lt;p&gt;
     * Constructor for MZTabDataLineParser.&lt;/p&gt;
     *
     * @param context a
     * {@link uk.ac.ebi.pride.jmztab2.utils.parser.MZTabParserContext} object.
     */
    protected MZTabDataLineParser(MZTabParserContext context) {
<span class="fc" id="L84">        super(context);</span>
<span class="fc" id="L85">    }</span>

    /**
     * Generate a mzTab data line parser.
     *
     * NOTICE: {@link uk.ac.ebi.pride.jmztab2.model.MZTabColumnFactory} maintain
     * a couple of {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn} which have
     * internal logical position and order. In physical mzTab file, we allow
     * user not obey this logical position organized way, and provide their date
     * with own order. In order to distinguish them, we use physical position (a
     * positive integer) to record the column location in mzTab file. And use
     * {@link uk.ac.ebi.pride.jmztab2.utils.parser.PositionMapping} structure
     * the maintain the mapping between them.
     *
     * @param context the parser context, keeping dynamic state and lookup
     * associations.
     * @param factory SHOULD NOT be set to null
     * @param positionMapping SHOULD NOT be set to null
     * @param metadata SHOULD NOT be set to null
     * @param errorList a
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.MZTabErrorList} object.
     */
    protected MZTabDataLineParser(MZTabParserContext context,
        MZTabColumnFactory factory, PositionMapping positionMapping,
        Metadata metadata, MZTabErrorList errorList) {
<span class="fc" id="L110">        this(context);</span>
<span class="pc bpc" id="L111" title="1 of 2 branches missed.">        if (factory == null) {</span>
<span class="nc" id="L112">            throw new NullPointerException(</span>
                &quot;Column header factory should be created first.&quot;);
        }
<span class="fc" id="L115">        this.factory = factory;</span>

<span class="fc" id="L117">        this.positionMapping = positionMapping;</span>
<span class="fc" id="L118">        this.exchangeMapping = positionMapping.reverse();</span>
<span class="fc" id="L119">        this.mapping = factory.getOffsetColumnsMap();</span>

<span class="pc bpc" id="L121" title="1 of 2 branches missed.">        if (metadata == null) {</span>
<span class="nc" id="L122">            throw new NullPointerException(&quot;Metadata should be parsed first.&quot;);</span>
        }
<span class="fc" id="L124">        this.metadata = metadata;</span>
<span class="pc bpc" id="L125" title="1 of 2 branches missed.">        this.errorList = errorList == null ? new MZTabErrorList() : errorList;</span>
<span class="fc" id="L126">    }</span>

    /**
     * {@inheritDoc}
     *
     * Validate and parse the data line, if there exist errors, add them into
     * {@link MZTabErrorList}.
     */
    @Override
    public void parse(int lineNumber, String line, MZTabErrorList errorList) throws MZTabException {
<span class="fc" id="L136">        super.parse(lineNumber, line, errorList);</span>
<span class="fc" id="L137">        checkCount();</span>

<span class="fc" id="L139">        int offset = checkData();</span>
<span class="pc bpc" id="L140" title="1 of 2 branches missed.">        if (offset != items.length) {</span>
<span class="nc" id="L141">            log.error(</span>
                &quot;Number of expected items after parsing header is: {} but data line has: {} items!&quot;,
<span class="nc" id="L143">                offset,</span>
<span class="nc" id="L144">                items.length);</span>
<span class="nc" id="L145">            log.error(&quot;Current mapping is: {}&quot;, mapping);</span>
<span class="nc" id="L146">            log.error(&quot;Items given: {} expected: {}&quot;, Arrays.toString(items),</span>
<span class="nc" id="L147">                Arrays.toString(line.split(&quot;\\t&quot;)));</span>
<span class="nc" id="L148">            this.errorList.add(new MZTabError(FormatErrorType.CountMatch,</span>
                lineNumber, &quot;&quot; + offset, &quot;&quot; + items.length));
        }
<span class="fc" id="L151">    }</span>

    /**
     * Check header line items size equals data line items size. The number of
     * Data line items does not match with the number of Header line items.
     * Normally, the user has not used the Unicode Horizontal Tab character
     * (Unicode codepoint 0009) as the column delimiter, there is a file
     * encoding error, or the user has not provided the definition of optional
     * columns in the header line.
     */
    private void checkCount() {
<span class="fc" id="L162">        int headerCount = mapping.size();</span>
<span class="fc" id="L163">        int dataCount = items.length - 1;</span>

<span class="pc bpc" id="L165" title="1 of 2 branches missed.">        if (headerCount != dataCount) {</span>
<span class="nc" id="L166">            log.error(</span>
                &quot;Number of expected items after parsing header is: {} but data line has: {} items!&quot;,
<span class="nc" id="L168">                headerCount,</span>
<span class="nc" id="L169">                dataCount);</span>
<span class="nc" id="L170">            log.error(&quot;Current mapping is: {}&quot;, mapping);</span>
<span class="nc" id="L171">            log.error(&quot;Items given: {} expected: {}&quot;, Arrays.toString(items),</span>
<span class="nc" id="L172">                Arrays.toString(line.split(&quot;\\t&quot;)));</span>
<span class="nc" id="L173">            this.errorList.add(new MZTabError(FormatErrorType.CountMatch,</span>
                lineNumber, &quot;&quot; + dataCount, &quot;&quot; + headerCount));
        }
<span class="fc" id="L176">    }</span>

    /**
     * Retrieve the data line to a type mzTab domain object.
     *
     * @return a typed mzTab domain object.
     */
    public abstract T getRecord();

    /**
     * Check and translate the columns into mzTab elements.
     *
     * @return a int.
     */
    protected abstract int checkData();

    /**
     * load best_search_engine_score[id], read id value.
     *
     * @param bestSearchEngineScoreLabel a {@link java.lang.String} object.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer loadBestSearchEngineScoreId(
        String bestSearchEngineScoreLabel) {
<span class="nc" id="L200">        Pattern pattern = Pattern.compile(</span>
            &quot;search_engine_score\\[(\\d+)\\](\\w+)?&quot;);
<span class="nc" id="L202">        Matcher matcher = pattern.matcher(bestSearchEngineScoreLabel);</span>

<span class="nc bnc" id="L204" title="All 2 branches missed.">        if (matcher.find()) {</span>
<span class="nc" id="L205">            return new Integer(matcher.group(1));</span>
        }

<span class="nc" id="L208">        return null;</span>
    }

    /**
     * load search_engine_score[id]_ms_run[..], read id value.
     *
     * @param searchEngineLabel a {@link java.lang.String} object.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer loadSearchEngineScoreId(String searchEngineLabel) {
<span class="nc" id="L218">        Pattern pattern = Pattern.compile(&quot;search_engine_score\\[(\\d+)\\]\\w*&quot;);</span>
<span class="nc" id="L219">        Matcher matcher = pattern.matcher(searchEngineLabel);</span>

<span class="nc bnc" id="L221" title="All 2 branches missed.">        if (matcher.find()) {</span>
<span class="nc" id="L222">            return new Integer(matcher.group(1));</span>
        }

<span class="nc" id="L225">        return null;</span>
    }

    /**
     * In the table-based sections (protein, peptide, and small molecule) there
     * MUST NOT be any empty cells. Some field not allow &quot;null&quot; value, for
     * example unit_id, accession and so on. In &quot;Complete&quot; file, in general
     * &quot;null&quot; values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param allowNull a boolean.
     * @return a {@link java.lang.String} object.
     */
    protected String checkData(IMZTabColumn column, String target,
        boolean allowNull) {
<span class="pc bpc" id="L241" title="3 of 4 branches missed.">        if (target == null &amp;&amp; allowNull) {</span>
<span class="nc" id="L242">            return null;</span>
        }
<span class="pc bpc" id="L244" title="1 of 2 branches missed.">        if (target == null) {</span>
<span class="nc" id="L245">            this.errorList.add(new MZTabError(LogicalErrorType.NULL, lineNumber,</span>
<span class="nc" id="L246">                column.getHeader()));</span>
<span class="nc" id="L247">            return null;</span>
        }

<span class="fc" id="L250">        target = target.trim();</span>
<span class="pc bpc" id="L251" title="1 of 2 branches missed.">        if (target.isEmpty()) {</span>
<span class="nc" id="L252">            this.errorList.add(new MZTabError(LogicalErrorType.NULL, lineNumber,</span>
<span class="nc" id="L253">                column.getHeader()));</span>
<span class="nc" id="L254">            return null;</span>
        }
<span class="pc bpc" id="L256" title="1 of 4 branches missed.">        if (MZTabConstants.NULL.equals(target) &amp;&amp; !allowNull) {</span>
<span class="nc" id="L257">            this.errorList.add(new MZTabError(LogicalErrorType.NULL, lineNumber,</span>
<span class="nc" id="L258">                column.getHeader()));</span>
<span class="nc" id="L259">            return null;</span>
        }

<span class="fc" id="L262">        return target;</span>
    }

    /**
     * In the table-based sections (protein, peptide, and small molecule) there
     * MUST NOT be any empty cells. Some field not allow &quot;null&quot; value, for
     * example unit_id, accession and so on. In &quot;Complete&quot; file, in general
     * &quot;null&quot; values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkString(IMZTabColumn column, String target) {
<span class="fc" id="L276">        return checkData(column, target, true);</span>
    }

    /**
     * In the table-based sections (protein, peptide, and small molecule) there
     * MUST NOT be any empty cells. Some field not allow &quot;null&quot; value, for
     * example unit_id, accession and so on. In &quot;Complete&quot; file, in general
     * &quot;null&quot; values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param allowNull if true, null target values will pass the check, if
     * false, the check will raise an error in the error list.
     * @return a {@link java.lang.String} object.
     */
    protected String checkString(IMZTabColumn column, String target,
        boolean allowNull) {
<span class="fc" id="L293">        return checkData(column, target, allowNull);</span>
    }

    /**
     * Check and translate target string into Integer. If parse is incorrect,
     * throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkInteger(IMZTabColumn column, String target) {
<span class="fc" id="L307">        return checkInteger(column, target, true);</span>
    }

    /**
     * Check and translate target string into Integer. If parse is incorrect,
     * throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param allowNull if true, null target values will pass the check, if
     * false, the check will raise an error in the error list.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkInteger(IMZTabColumn column, String target,
        boolean allowNull) {
<span class="fc" id="L324">        String result = checkData(column, target, allowNull);</span>

<span class="pc bpc" id="L326" title="1 of 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="fc" id="L327">            return null;</span>
        }

<span class="fc" id="L330">        Integer value = parseInteger(result);</span>
<span class="pc bpc" id="L331" title="1 of 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L332">            this.errorList.add(new MZTabError(FormatErrorType.Integer,</span>
<span class="nc" id="L333">                lineNumber, column.getHeader(), target));</span>
        }

<span class="fc" id="L336">        return value;</span>
    }

    /**
     * Check and translate target string into Double. If parse is incorrect,
     * throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Double}
     * error.
     *
     * NOTICE: If ratios are included and the denominator is zero, the &quot;INF&quot;
     * value MUST be used. If the result leads to calculation errors (for
     * example 0/0), this MUST be reported as &quot;not a number&quot; (&quot;NaN&quot;).
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkDouble(IMZTabColumn column, String target) {
<span class="fc" id="L354">        return checkDouble(column, target, true);</span>
    }

    /**
     * Check and translate target string into Double. If parse is incorrect,
     * throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Double}
     * error.
     *
     * NOTICE: If ratios are included and the denominator is zero, the &quot;INF&quot;
     * value MUST be used. If the result leads to calculation errors (for
     * example 0/0), this MUST be reported as &quot;not a number&quot; (&quot;NaN&quot;).
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param allowNull if true, null target values will pass the check, if
     * false, the check will raise an error in the error list.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkDouble(IMZTabColumn column, String target,
        boolean allowNull) {
<span class="fc" id="L375">        String result = checkData(column, target, allowNull);</span>

<span class="pc bpc" id="L377" title="1 of 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="fc" id="L378">            return null;</span>
        }

<span class="fc" id="L381">        Double value = parseDouble(result);</span>
<span class="pc bpc" id="L382" title="1 of 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L383">            this.errorList.add(</span>
                new MZTabError(FormatErrorType.Double, lineNumber, column.
<span class="nc" id="L385">                    getHeader(), target));</span>
<span class="nc" id="L386">            return null;</span>
        }
<span class="pc bpc" id="L388" title="1 of 4 branches missed.">        if (value.equals(Double.NaN) || value.equals(Double.POSITIVE_INFINITY)) {</span>
<span class="fc" id="L389">            return value;</span>
        }

<span class="fc" id="L392">        return value;</span>
    }

    /**
     * Check and translate target string into parameter list which split by '|'
     * character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#ParamList}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Parameter&gt; checkParamList(IMZTabColumn column, String target) {
<span class="nc" id="L406">        String result = checkData(column, target, true);</span>

<span class="nc bnc" id="L408" title="All 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L409">            return new ArrayList&lt;&gt;(BAR);</span>
        }

<span class="nc" id="L412">        List&lt;Parameter&gt; paramList = parseParamList(result);</span>
<span class="nc bnc" id="L413" title="All 2 branches missed.">        if (paramList.isEmpty()) {</span>
<span class="nc" id="L414">            this.errorList.add(new MZTabError(FormatErrorType.ParamList,</span>
<span class="nc" id="L415">                lineNumber, &quot;Column &quot; + column.getHeader(), target));</span>
        }
<span class="nc bnc" id="L417" title="All 2 branches missed.">        for (Parameter param : paramList) {</span>
<span class="nc bnc" id="L418" title="All 4 branches missed.">            if (param != null &amp;&amp; param.getCvAccession() != null &amp;&amp; !param.</span>
<span class="nc" id="L419">                getCvAccession().</span>
<span class="nc bnc" id="L420" title="All 2 branches missed.">                isEmpty()) {</span>
<span class="nc" id="L421">                if (!param.getCvAccession().</span>
<span class="nc bnc" id="L422" title="All 2 branches missed.">                    contains(&quot;:&quot;)) {</span>
<span class="nc" id="L423">                    this.errorList.add(new MZTabError(</span>
                        FormatErrorType.ParamAccessionNotNamespaced, lineNumber,
<span class="nc" id="L425">                        column.getHeader(), param.getCvAccession(),</span>
<span class="nc" id="L426">                        new ParameterConverter().convert(param)));</span>
                }
            }
<span class="nc" id="L429">        }</span>

<span class="nc" id="L431">        return paramList;</span>
    }

    /**
     * &lt;p&gt;
     * checkParameter.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param target a {@link java.lang.String} object.
     * @param allowNull a boolean.
     * @return a {@link de.isas.mztab2.model.Parameter} object.
     */
    protected Parameter checkParameter(IMZTabColumn column, String target,
        boolean allowNull) {
<span class="fc" id="L446">        String result = checkData(column, target, true);</span>
<span class="pc bpc" id="L447" title="2 of 6 branches missed.">        if (result == null || (result.equalsIgnoreCase(NULL) &amp;&amp; !allowNull)) {</span>
<span class="nc" id="L448">            this.errorList.add(new MZTabError(FormatErrorType.Param, lineNumber,</span>
<span class="nc" id="L449">                &quot;Column &quot; + column.getHeader(), target));</span>
        }
<span class="fc" id="L451">        Parameter param = MZTabUtils.parseParam(target);</span>
<span class="pc bpc" id="L452" title="1 of 4 branches missed.">        if (param != null &amp;&amp; param.getCvAccession() != null &amp;&amp; !param.</span>
<span class="fc" id="L453">            getCvAccession().</span>
<span class="fc bfc" id="L454" title="All 2 branches covered.">            isEmpty()) {</span>
<span class="fc" id="L455">            if (!param.getCvAccession().</span>
<span class="pc bpc" id="L456" title="1 of 2 branches missed.">                contains(&quot;:&quot;)) {</span>
<span class="nc" id="L457">                this.errorList.add(new MZTabError(</span>
                    FormatErrorType.ParamAccessionNotNamespaced, lineNumber,
<span class="nc" id="L459">                    column.getHeader(), param.getCvAccession(),</span>
<span class="nc" id="L460">                    new ParameterConverter().convert(param)));</span>
            }
<span class="pc bpc" id="L462" title="2 of 6 branches missed.">        } else if (param == null &amp;&amp; result != null &amp;&amp; !result.isEmpty() &amp;&amp; !(result.</span>
<span class="pc bpc" id="L463" title="1 of 2 branches missed.">            equalsIgnoreCase(NULL))) {</span>
<span class="nc" id="L464">            this.errorList.add(new MZTabError(FormatErrorType.Param, lineNumber,</span>
<span class="nc" id="L465">                &quot;Column &quot; + column.getHeader(), target));</span>
        }
<span class="fc" id="L467">        return param;</span>
    }

    /**
     * Check and translate target string into parameter list which split by
     * splitChar character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param splitChar a char.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;String&gt; checkStringList(IMZTabColumn column, String target,
        char splitChar) {
<span class="fc" id="L483">        String result = checkData(column, target, true);</span>

<span class="pc bpc" id="L485" title="1 of 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="fc" id="L486">            return new ArrayList&lt;&gt;(splitChar);</span>
        }

<span class="fc" id="L489">        List&lt;String&gt; stringList = parseStringList(splitChar, result);</span>
<span class="pc bpc" id="L490" title="1 of 2 branches missed.">        if (stringList.isEmpty()) {</span>
<span class="nc" id="L491">            this.errorList.add(new MZTabError(FormatErrorType.StringList,</span>
<span class="nc" id="L492">                lineNumber, column.getHeader(), result, &quot;&quot; + splitChar));</span>
        }

<span class="fc" id="L495">        return stringList;</span>
    }

    /**
     * Check and translate target string into integer list which split by
     * splitChar character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param splitChar a char.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Integer&gt; checkIntegerList(IMZTabColumn column, String target,
        char splitChar) {
<span class="fc" id="L511">        return checkIntegerList(column, target, splitChar, true);</span>
    }

    /**
     * Check and translate target string into integer list which split by
     * splitChar character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @param splitChar a char.
     * @param allowNull if true, null will be treated as a valid element of the
     * list. Otherwise, an error will be added to the error list.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Integer&gt; checkIntegerList(IMZTabColumn column, String target,
        char splitChar, boolean allowNull) {
<span class="fc" id="L529">        String result = checkData(column, target, allowNull);</span>

<span class="pc bpc" id="L531" title="1 of 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="fc" id="L532">            return new ArrayList&lt;&gt;(splitChar);</span>
        }

<span class="fc" id="L535">        List&lt;Integer&gt; stringList = parseIntegerList(result);</span>
<span class="pc bpc" id="L536" title="1 of 2 branches missed.">        if (stringList.isEmpty()) {</span>
<span class="nc" id="L537">            this.errorList.add(new MZTabError(FormatErrorType.IntegerList,</span>
<span class="nc" id="L538">                lineNumber, column.getHeader(), result, &quot;&quot; + splitChar));</span>
        }

<span class="fc" id="L541">        return stringList;</span>
    }

    /**
     * Check and translate target string into parameter list which split by
     * splitChar character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Double&gt; checkDoubleList(IMZTabColumn column, String target) {
<span class="fc" id="L555">        String result = checkData(column, target, true);</span>

<span class="pc bpc" id="L557" title="2 of 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L558">            return new ArrayList&lt;&gt;(MZTabConstants.BAR);</span>
        }

<span class="fc" id="L561">        List&lt;Double&gt; doubleList = parseDoubleList(target);</span>
<span class="pc bpc" id="L562" title="1 of 2 branches missed.">        if (doubleList.isEmpty()) {</span>
<span class="nc" id="L563">            this.errorList.add(new MZTabError(FormatErrorType.DoubleList,</span>
<span class="nc" id="L564">                lineNumber, column.getHeader(), result, &quot;&quot; + MZTabConstants.BAR));</span>
        }

<span class="fc" id="L567">        return doubleList;</span>
    }

    /**
     * Check and translate target to
     * {@link uk.ac.ebi.pride.jmztab2.model.MZBoolean}. Only &quot;0&quot; and &quot;1&quot; allow
     * used in express Boolean (0/1). If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#MZBoolean}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param target SHOULD NOT be empty.
     * @return a {@link uk.ac.ebi.pride.jmztab2.model.MZBoolean} object.
     */
    protected MZBoolean checkMZBoolean(IMZTabColumn column, String target) {
<span class="nc" id="L582">        String result = checkData(column, target, true);</span>

<span class="nc bnc" id="L584" title="All 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L585">            return null;</span>
        }

<span class="nc" id="L588">        MZBoolean value = MZBoolean.findBoolean(result);</span>
<span class="nc bnc" id="L589" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L590">            this.errorList.add(new MZTabError(FormatErrorType.MZBoolean,</span>
<span class="nc" id="L591">                lineNumber, column.getHeader(), result));</span>
        }

<span class="nc" id="L594">        return value;</span>
    }

    /**
     * Check target string. Normally, description can set &quot;null&quot;. But in
     * &quot;Complete&quot; file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param description SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkDescription(IMZTabColumn column, String description) {
<span class="nc" id="L607">        return checkData(column, description, true);</span>
    }

    /**
     * Check and translate taxid string into Integer. If exists error during
     * parse, raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error. Normally, taxid may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param taxid SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkTaxid(IMZTabColumn column, String taxid) {
<span class="nc" id="L622">        return checkInteger(column, taxid);</span>
    }

    /**
     * Check target string. Normally, species can set &quot;null&quot;. But in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param species SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkSpecies(IMZTabColumn column, String species) {
<span class="nc" id="L635">        return checkData(column, species, true);</span>
    }

    /**
     * Check target string. Normally, database can set &quot;null&quot;. But in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param database SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkDatabase(IMZTabColumn column, String database) {
<span class="nc" id="L648">        return checkData(column, database, true);</span>
    }

    /**
     * Check target string. Normally, databaseVersion can set &quot;null&quot;. But in
     * &quot;Complete&quot; file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param databaseVersion SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkDatabaseVersion(IMZTabColumn column,
        String databaseVersion) {
<span class="nc" id="L662">        return checkData(column, databaseVersion, true);</span>
    }

    /**
     * Check and translate searchEngine string into parameter list which split
     * by '|' character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#ParamList}
     * error. Normally, searchEngine may be set to &quot;null&quot;; in general &quot;null&quot;
     * values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param searchEngine SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Parameter&gt; checkSearchEngine(IMZTabColumn column,
        String searchEngine) {
<span class="nc" id="L678">        return checkParamList(column, searchEngine);</span>
    }

    /**
     * The best search engine score (for this type of score) for the given
     * peptide across all replicates reported. The type of score MUST be defined
     * in the metadata section. If the peptide was not identified by the
     * specified search engine, “null” MUST be reported.
     *
     * @param column SHOULD NOT be set to null
     * @param bestSearchEngineScore SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkBestSearchEngineScore(IMZTabColumn column,
        String bestSearchEngineScore) {
<span class="nc" id="L693">        return checkDouble(column, bestSearchEngineScore);</span>
    }

    /**
     * The search engine score for the given peptide in the defined ms run. The
     * type of score MUST be defined in the metadata section. If the peptide was
     * not identified by the specified search engine “null” must be reported.
     *
     * @param column SHOULD NOT be set to null
     * @param searchEngineScore SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkSearchEngineScore(IMZTabColumn column,
        String searchEngineScore) {
<span class="nc" id="L707">        return checkDouble(column, searchEngineScore);</span>
    }

    /**
     * Check and translate numPSMs string into Integer. If exists error during
     * parse, raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error. Normally, numPSMs may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param numPSMs SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkNumPSMs(IMZTabColumn column, String numPSMs) {
<span class="nc" id="L722">        return checkInteger(column, numPSMs);</span>
    }

    /**
     * Check and translate numPeptidesDistinct string into Integer. If exists
     * error during parse, raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error. Normally, numPeptidesDistinct can set &quot;null&quot;, but in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param numPeptidesDistinct SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkNumPeptidesDistinct(IMZTabColumn column,
        String numPeptidesDistinct) {
<span class="nc" id="L738">        return checkInteger(column, numPeptidesDistinct);</span>
    }

    /**
     * Check and translate numPeptidesUnique string into Integer. If exists
     * error during parse, raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error. Normally, numPeptidesUnique can set &quot;null&quot;, but in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param numPeptidesUnique SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkNumPeptidesUnique(IMZTabColumn column,
        String numPeptidesUnique) {
<span class="nc" id="L754">        return checkInteger(column, numPeptidesUnique);</span>
    }

    /**
     * Check and translate target string into parameter list which split by ','
     * character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error. Normally, ambiguityMembers may be set to &quot;null&quot;; in general &quot;null&quot;
     * values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param ambiguityMembers SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;String&gt; checkAmbiguityMembers(IMZTabColumn column,
        String ambiguityMembers) {
<span class="nc" id="L770">        return checkStringList(column, ambiguityMembers, COMMA);</span>
    }

    /**
     * Checks the provided URI string.
     *
     * @param column SHOULD NOT be set to null
     * @param uri a {@link java.lang.String} object, conforming to URI format.
     * @return the uri as an ASCII encoded string.
     */
    protected String checkURI(IMZTabColumn column, String uri) {
<span class="fc" id="L781">        String result_uri = checkData(column, uri, true);</span>

<span class="pc bpc" id="L783" title="1 of 4 branches missed.">        if (result_uri == null || result_uri.equalsIgnoreCase(NULL)) {</span>
<span class="fc" id="L784">            return null;</span>
        }

<span class="fc" id="L787">        java.net.URI result = parseURI(result_uri);</span>
<span class="pc bpc" id="L788" title="1 of 2 branches missed.">        if (result == null) {</span>
<span class="nc" id="L789">            this.errorList.add(new MZTabError(FormatErrorType.URI, lineNumber,</span>
<span class="nc" id="L790">                &quot;Column &quot; + column.getHeader(), result_uri));</span>
<span class="nc" id="L791">            return null;</span>
        } else {
<span class="fc" id="L793">            return result.toASCIIString();</span>
        }
    }

    /**
     * Check and translate spectraRef string into
     * {@link de.isas.mztab2.model.SpectraRef} list. If parse incorrect, or
     * ms_run not defined in metadata raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#SpectraRef}
     * error. Normally, spectraRef may be set to &quot;null&quot;; in general &quot;null&quot;
     * values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param spectraRef SHOULD NOT be empty.
     * @param context a
     * {@link uk.ac.ebi.pride.jmztab2.utils.parser.MZTabParserContext} object.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;SpectraRef&gt; checkSpectraRef(MZTabParserContext context,
        IMZTabColumn column, String spectraRef) {
<span class="nc" id="L813">        return checkSpectraRef(context, column, spectraRef, false);</span>
    }

    /**
     * Check and translate spectraRef string into
     * {@link de.isas.mztab2.model.SpectraRef} list. If parse incorrect, or
     * ms_run not defined in metadata raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#SpectraRef}
     * error. Normally, spectraRef may be set to &quot;null&quot;; in general &quot;null&quot;
     * values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param spectraRef SHOULD NOT be empty.
     * @param context a
     * {@link uk.ac.ebi.pride.jmztab2.utils.parser.MZTabParserContext} object.
     * @param allowNull if true, allow null for value. Otherwise, an error will
     * be added to the error list.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;SpectraRef&gt; checkSpectraRef(MZTabParserContext context,
        IMZTabColumn column, String spectraRef, boolean allowNull) {
<span class="fc" id="L834">        String result_spectraRef = checkData(column, spectraRef, allowNull);</span>

<span class="pc bpc" id="L836" title="1 of 2 branches missed.">        if (result_spectraRef == null || result_spectraRef.</span>
<span class="pc bpc" id="L837" title="1 of 2 branches missed.">            equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L838">            return new SplitList&lt;&gt;(BAR);</span>
        }

<span class="fc" id="L841">        List&lt;SpectraRef&gt; refList = parseSpectraRefList(context, metadata,</span>
            result_spectraRef);
<span class="pc bpc" id="L843" title="1 of 2 branches missed.">        if (refList.isEmpty()) {</span>
<span class="nc" id="L844">            this.errorList.add(new MZTabError(FormatErrorType.SpectraRef,</span>
<span class="nc" id="L845">                lineNumber, column.getHeader(), result_spectraRef));</span>
        } else {
<span class="fc bfc" id="L847" title="All 2 branches covered.">            for (SpectraRef ref : refList) {</span>
<span class="fc" id="L848">                MsRun run = ref.getMsRun();</span>
<span class="pc bpc" id="L849" title="1 of 2 branches missed.">                if (!Optional.ofNullable(run.getLocation()).isPresent()) {</span>
                    //As the location can be null and the field is mandatory, this is not an error, it is a warning
<span class="nc" id="L851">                    this.errorList.add(new MZTabError(</span>
                        LogicalErrorType.SpectraRef, lineNumber, column.
<span class="nc" id="L853">                            getHeader(), result_spectraRef, &quot;ms_run[&quot; + run.</span>
<span class="nc" id="L854">                            getId() + &quot;]-location&quot;));</span>
                }
<span class="fc" id="L856">            }</span>
        }

<span class="fc" id="L859">        return refList;</span>
    }

    /**
     * Check target string. Normally, pre can set &quot;null&quot;. &quot;null&quot; values should
     * only be given, if no value is available and where the specification
     * allows for &quot;null&quot; explicitly.&quot;
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param pre SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkPre(IMZTabColumn column, String pre) {
<span class="nc" id="L873">        return checkData(column, pre, true);</span>
    }

    /**
     * Check target string. Normally, post can set &quot;null&quot;. But in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param post SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkPost(IMZTabColumn column, String post) {
<span class="nc" id="L886">        return checkData(column, post, true);</span>
    }

    /**
     * Check target string. Normally, start can set &quot;null&quot;. But in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param start SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkStart(IMZTabColumn column, String start) {
<span class="nc" id="L899">        return checkData(column, start, true);</span>
    }

    /**
     * Check target string. Normally, end can set &quot;null&quot;. But in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param end SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkEnd(IMZTabColumn column, String end) {
<span class="nc" id="L912">        return checkData(column, end, true);</span>
    }

    /**
     * Check and translate target string into string list which split by ','
     * character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error. Besides, each item in list should be start with &quot;GO:&quot;, otherwise
     * system raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#GOTermList}
     * error. Normally, go_terms may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param go_terms SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;String&gt; checkGOTerms(IMZTabColumn column, String go_terms) {
<span class="nc" id="L930">        String result_go_terms = checkData(column, go_terms, true);</span>

<span class="nc bnc" id="L932" title="All 4 branches missed.">        if (result_go_terms == null || result_go_terms.equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L933">            return new ArrayList&lt;&gt;(COMMA);</span>
        }

<span class="nc" id="L936">        List&lt;String&gt; stringList = parseGOTermList(result_go_terms);</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">        if (stringList.isEmpty()) {</span>
<span class="nc" id="L938">            this.errorList.add(new MZTabError(FormatErrorType.GOTermList,</span>
<span class="nc" id="L939">                lineNumber, column.getHeader(), result_go_terms));</span>
        }

<span class="nc" id="L942">        return stringList;</span>
    }

    /**
     * Check and translate protein_coverage string into Double. If parse is
     * incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Double}
     * error. protein_coverage range should be in the [0, 1), otherwise raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.LogicalErrorType#ProteinCoverage}
     * error.
     *
     * NOTICE: If ratios are included and the denominator is zero, the &quot;INF&quot;
     * value MUST be used. If the result leads to calculation errors (for
     * example 0/0), this MUST be reported as &quot;not a number&quot; (&quot;NaN&quot;).
     *
     * @param column SHOULD NOT be set to null
     * @param protein_coverage SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkProteinCoverage(IMZTabColumn column,
        String protein_coverage) {
<span class="nc" id="L963">        Double result = checkDouble(column, protein_coverage);</span>

<span class="nc bnc" id="L965" title="All 2 branches missed.">        if (result == null) {</span>
<span class="nc" id="L966">            return null;</span>
        }

<span class="nc bnc" id="L969" title="All 4 branches missed.">        if (result &lt; 0 || result &gt; 1) {</span>
<span class="nc" id="L970">            this.errorList.add(new MZTabError(LogicalErrorType.ProteinCoverage,</span>
<span class="nc" id="L971">                lineNumber, column.getHeader(), printDouble(result)));</span>
<span class="nc" id="L972">            return null;</span>
        }

<span class="nc" id="L975">        return result;</span>
    }

    /**
     * Check and translate peptide sequence. 'O' and 'U' are encoded by codons
     * that are usually interpreted as stop codons, which can not displayed in
     * the sequence. So, if find it, system raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Sequence}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param sequence SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkSequence(IMZTabColumn column, String sequence) {
<span class="nc" id="L990">        String result = checkData(column, sequence, true);</span>

<span class="nc bnc" id="L992" title="All 2 branches missed.">        if (result == null) {</span>
<span class="nc" id="L993">            return null;</span>
        }

<span class="nc" id="L996">        result = result.toUpperCase();</span>

<span class="nc" id="L998">        Pattern pattern = Pattern.compile(&quot;[OU]&quot;);</span>
<span class="nc" id="L999">        Matcher matcher = pattern.matcher(result);</span>
<span class="nc bnc" id="L1000" title="All 2 branches missed.">        if (matcher.find()) {</span>
<span class="nc" id="L1001">            this.errorList.add(new MZTabError(FormatErrorType.Sequence,</span>
<span class="nc" id="L1002">                lineNumber, column.getHeader(), sequence));</span>
        }

<span class="nc" id="L1005">        return result;</span>
    }

    /**
     * Check and translate psm_id string into Integer. If exists error during
     * parse, raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error. Normally, psm_id may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param psm_id SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkPSMID(IMZTabColumn column, String psm_id) {
<span class="nc" id="L1020">        return checkInteger(column, psm_id);</span>
    }

    /**
     * Check and translate unique to
     * {@link uk.ac.ebi.pride.jmztab2.model.MZBoolean}. Only &quot;0&quot; and &quot;1&quot; allow
     * used in express Boolean (0/1). If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#MZBoolean}
     * error.
     *
     * @param column SHOULD NOT be set to null
     * @param unique SHOULD NOT be empty.
     * @return a {@link uk.ac.ebi.pride.jmztab2.model.MZBoolean} object.
     */
    protected MZBoolean checkUnique(IMZTabColumn column, String unique) {
<span class="nc" id="L1035">        return checkMZBoolean(column, unique);</span>
    }

    /**
     * Check and translate charge string into Integer. If exists error during
     * parse, raise
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Integer}
     * error. Normally, charge may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param charge SHOULD NOT be empty.
     * @return a {@link java.lang.Integer} object.
     */
    protected Integer checkCharge(IMZTabColumn column, String charge) {
<span class="nc" id="L1050">        return checkInteger(column, charge);</span>
    }

    /**
     * Check and translate mass_to_charge string into Double. If parse is
     * incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Double}
     * error.
     *
     * NOTICE: If ratios are included and the denominator is zero, the &quot;INF&quot;
     * value MUST be used. If the result leads to calculation errors (for
     * example 0/0), this MUST be reported as &quot;not a number&quot; (&quot;NaN&quot;).
     *
     * @param column SHOULD NOT be set to null
     * @param mass_to_charge SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkMassToCharge(IMZTabColumn column,
        String mass_to_charge) {
<span class="nc" id="L1069">        return checkDouble(column, mass_to_charge);</span>
    }

    /**
     * Check and translate exp_mass_to_charge string into Double. If parse is
     * incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Double}
     * error.
     *
     * NOTICE: If ratios are included and the denominator is zero, the &quot;INF&quot;
     * value MUST be used. If the result leads to calculation errors (for
     * example 0/0), this MUST be reported as &quot;not a number&quot; (&quot;NaN&quot;).
     *
     * @param column SHOULD NOT be set to null
     * @param exp_mass_to_charge SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkExpMassToCharge(IMZTabColumn column,
        String exp_mass_to_charge) {
<span class="nc" id="L1088">        return checkDouble(column, exp_mass_to_charge);</span>
    }

    /**
     * Check and translate calc_mass_to_charge string into Double. If parse is
     * incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#Double}
     * error.
     *
     * NOTICE: If ratios are included and the denominator is zero, the &quot;INF&quot;
     * value MUST be used. If the result leads to calculation errors (for
     * example 0/0), this MUST be reported as &quot;not a number&quot; (&quot;NaN&quot;).
     *
     * @param column SHOULD NOT be set to null
     * @param calc_mass_to_charge SHOULD NOT be empty.
     * @return a {@link java.lang.Double} object.
     */
    protected Double checkCalcMassToCharge(IMZTabColumn column,
        String calc_mass_to_charge) {
<span class="nc" id="L1107">        return checkDouble(column, calc_mass_to_charge);</span>
    }

    /**
     * Check and translate identifier string into string list which split by '|'
     * character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error. Normally, identifier may be set to &quot;null&quot;; in general &quot;null&quot;
     * values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param identifier SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;String&gt; checkIdentifier(IMZTabColumn column,
        String identifier) {
<span class="nc" id="L1123">        return checkStringList(column, identifier, BAR);</span>
    }

    /**
     * Check chemical_formula string. Normally, chemical_formula can set &quot;null&quot;.
     * But in &quot;Complete&quot; file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @see #checkData(IMZTabColumn, String, boolean)
     * @param column SHOULD NOT be set to null
     * @param chemical_formula SHOULD NOT be empty.
     * @return a {@link java.lang.String} object.
     */
    protected String checkChemicalFormula(IMZTabColumn column,
        String chemical_formula) {
<span class="nc" id="L1137">        return checkData(column, chemical_formula, true);</span>
    }

    /**
     * Check and translate smiles string into parameter list which split by '|'
     * character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error. Normally, smiles may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param smiles SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;String&gt; checkSmiles(IMZTabColumn column, String smiles) {
<span class="fc" id="L1152">        return checkStringList(column, smiles, BAR);</span>
    }

    /**
     * Check and translate inchi_key string into parameter list which split by
     * '|' character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#StringList}
     * error. Normally, inchi_key may be set to &quot;null&quot;; in general &quot;null&quot; values
     * SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param inchi_key SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;String&gt; checkInchiKey(IMZTabColumn column, String inchi_key) {
<span class="nc" id="L1167">        return checkStringList(column, inchi_key, BAR);</span>
    }

    /**
     * Check and translate retention_time string into Double list which split by
     * '|' character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#DoubleList}
     * error. Normally, retention_time may be set to &quot;null&quot;; in general &quot;null&quot;
     * values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param retention_time SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Double&gt; checkRetentionTime(IMZTabColumn column,
        String retention_time) {
<span class="nc" id="L1183">        String result = checkData(column, retention_time, true);</span>

<span class="nc bnc" id="L1185" title="All 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L1186">            return new SplitList&lt;&gt;(BAR);</span>
        }

<span class="nc" id="L1189">        List&lt;Double&gt; valueList = parseDoubleList(result);</span>
<span class="nc bnc" id="L1190" title="All 2 branches missed.">        if (valueList.isEmpty()) {</span>
<span class="nc" id="L1191">            this.errorList.add(new MZTabError(FormatErrorType.DoubleList,</span>
<span class="nc" id="L1192">                lineNumber, column.getHeader(), result, &quot;&quot; + BAR));</span>
        }

<span class="nc" id="L1195">        return valueList;</span>
    }

    /**
     * Check and translate retention_time_window string into Double list which
     * split by '|' character.. If parse is incorrect, throws
     * {@link uk.ac.ebi.pride.jmztab2.utils.errors.FormatErrorType#DoubleList}
     * error. Normally, retention_time_window can set &quot;null&quot;, but in &quot;Complete&quot;
     * file, in general &quot;null&quot; values SHOULD not be given.
     *
     * @param column SHOULD NOT be set to null
     * @param retention_time_window SHOULD NOT be empty.
     * @return a {@link java.util.List} object.
     */
    protected List&lt;Double&gt; checkRetentionTimeWindow(IMZTabColumn column,
        String retention_time_window) {
<span class="nc" id="L1211">        String result = checkData(column, retention_time_window, true);</span>

<span class="nc bnc" id="L1213" title="All 4 branches missed.">        if (result == null || result.equalsIgnoreCase(NULL)) {</span>
<span class="nc" id="L1214">            return new SplitList&lt;&gt;(BAR);</span>
        }

<span class="nc" id="L1217">        List&lt;Double&gt; valueList = parseDoubleList(result);</span>
<span class="nc bnc" id="L1218" title="All 2 branches missed.">        if (valueList.isEmpty()) {</span>
<span class="nc" id="L1219">            this.errorList.add(new MZTabError(FormatErrorType.DoubleList,</span>
<span class="nc" id="L1220">                lineNumber, column.getHeader(), result, &quot;&quot; + BAR));</span>
        }

<span class="nc" id="L1223">        return valueList;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.3.201901230119</span></div></body></html>